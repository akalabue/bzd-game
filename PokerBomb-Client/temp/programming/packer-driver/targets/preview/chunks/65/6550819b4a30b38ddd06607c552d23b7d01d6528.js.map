{"version":3,"sources":["file:///D:/Documents/OneDrive/%E6%A1%8C%E9%9D%A2/%E5%85%B6%E4%BB%96%E6%96%87%E4%BB%B6%E5%A4%B9/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/PokerBomb/PokerBomb-Client/assets/Script/games/bazhadan/BZDSceneMgt.ts"],"names":["_decorator","Component","Node","Label","SpriteAtlas","Sprite","director","tween","Vec3","PushCardVo","BZDSoundMgt","ccclass","property","BZDSceneMgt","cardList","cardSet","Set","pushcardVo","start","init","console","log","globalThis","_eventtarget","on","onRequestRoomInfo","onUserReady","onDealCards","onPushCards","onUpdatePoints","panGameOver","newUserJoinRoom","data","seat","newUserInfo","userInfo","updateTheseat","_userInfo","room_seat","seatName","string","userName","seatTotalPoints","totalPoints","seatJuPoints","juPoints","seatPanPoints","panPoints","readyOk","active","userStatus","status","panOver","info","panGameOverInfo","panGameInfo","panGameInfos","i","label","getChildByName","getComponent","points","teamPoints","total","roomInfo","roomId","gamecount","currentNumbers","gameNumbers","scoreNumbers","updateAllSeats","pokerView","users","gameRoles","cur","userId","user_id","j","passLable","pushCardsView","bool","readyBtn","cancelReadyBtn","readyNumbers","createUserId","startBtn","userCards","showPushCards","showPoker","p","q","prePushSeat","pushCardBtn","passBtn","paiPoints","curPoints","mySeat","ready","isReady","onReadyBtnClicked","bzdSoundMgt","play","_BZDClient","sendMessage","room_id","onCancelReadyBtnClicked","onStartBtnClicked","onExitRoomBtnClicked","loadScene","cleanPushCards","cards","pushSeat","onloadAtlas","bpk","pokerAtlas","getSpriteFrame","x","y","z","pk","cardName","cardNode","setPosition","sp","spriteFrame","to","position","call","length","onCardClicked","type","arg","getPosition","has","delete","add","onPushCardBtnClicked","JSON","stringify","curCardList","Array","from","sort","a","b","spf","cardValue","name","push","Number","curSeat","pushCardsInfo","randomAudioName","random","min","max","Math","floor","arr","idx","isRight","audioName","preSeat","preStatus","size","d_x","preCardList","clear","preUserCards","myStatus","showPushCardsBtn","onPassBtnClicked","cleanCardSet","pcv","onPanOverPageClosedBtnClicked","playAudioEffect"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, System, assetManager, AssetManager, SpriteAtlas, Prefab, instantiate, resources, SpriteFrame, Sprite, director, tween, Vec3 } from 'cc';\nimport { GameRole } from '../../common/GameRole';\nimport { PushCardVo } from '../../common/PushCardVo';\nimport { BZDSoundMgt } from './BZDSoundMgt';\nimport { Poker } from './Poker';\nimport { PokerCtr } from './PokerCtr';\nconst { ccclass, property } = _decorator;\n\n@ccclass('BZDSceneMgt')\nexport class BZDSceneMgt extends Component {\n\n    @property(Label)\n    public roomId: Label\n    @property(Label)\n    public gamecount: Label\n\n    @property(Label)\n    seatName: Label[] = [];\n    @property(Label)\n    seatTotalPoints: Label[] = [];\n    \n    @property(Label)\n    seatJuPoints: Label[] = []\n    \n    @property(Label)\n    seatPanPoints: Label[] = []\n    \n    @property(Node)\n    readyOk: Node[] = []\n\n    @property(Node)\n    pushCardsView: Node[] = []\n\n    @property(Node)\n    passLable: Node[] = []\n    \n    @property(Node)\n    readyBtn: Node\n    \n    @property(Node)\n    cancelReadyBtn: Node\n    \n    @property(Node)\n    startBtn: Node\n\n    @property(Node)\n    pokerView: Node\n\n    @property(Node)\n    passBtn: Node\n\n    @property(Node)\n    pushCardBtn: Node\n\n    @property(Label)\n    paiPoints: Label\n\n    @property(Node)\n    panOver: Node\n\n    @property(SpriteAtlas)\n    pokerAtlas: SpriteAtlas;\n\n    @property(BZDSoundMgt)\n    bzdSoundMgt: BZDSoundMgt\n\n\n    cardList: number[];\n    cardSet: Set<number> = new Set;\n    // pushCardSet: Set<number> = new Set;\n    pushcardVo: PushCardVo\n\n    \n    start() {\n        this.init();\n        console.log(\"怡怡最美~\");\n        console.log(\"最爱怡怡~\");\n    }\n\n    private init(){\n        this.pushcardVo = new PushCardVo();\n        globalThis._eventtarget.on(\"requestRoomInfo\", this.onRequestRoomInfo, this);\n        globalThis._eventtarget.on(\"userReady\", this.onUserReady, this);\n        globalThis._eventtarget.on(\"dealCards\", this.onDealCards, this);\n        globalThis._eventtarget.on(\"pushCards\", this.onPushCards, this);\n        globalThis._eventtarget.on(\"updatePoints\", this.onUpdatePoints, this);\n        globalThis._eventtarget.on(\"panGameOver\", this.panGameOver, this);\n        globalThis._eventtarget.on(\"newUserJoinRoom\", this.newUserJoinRoom, this);\n    }\n    newUserJoinRoom(data) {\n        let seat = data.newUserInfo.seat;\n        let userInfo = data.newUserInfo.userInfo;\n        this.updateTheseat(seat, userInfo);\n    }\n    updateTheseat(seat: any, userInfo: any) {\n        if(seat == globalThis._userInfo.room_seat)return;\n        seat = (seat - globalThis._userInfo.room_seat + 4) % 4;\n        this.seatName[seat].string = userInfo.userName;\n        this.seatTotalPoints[seat].string = \"总分:\" + userInfo.totalPoints;\n        this.seatJuPoints[seat].string = \"局:\" + userInfo.juPoints;\n        this.seatPanPoints[seat].string = \"盘:\" + userInfo.panPoints;\n        this.readyOk[seat].active = (userInfo.userStatus.status == \"READY\");\n    }\n    panGameOver(data) {\n        this.panOver.active = true;\n        let info = data.panGameOverInfo;\n        let panGameInfo = info.panGameInfos;\n        let i = globalThis._userInfo.room_seat % 2;\n        let label = this.panOver.getChildByName(\"计分板\").getChildByName(\"本队积分详情\").getComponent(Label);\n        label.string = \"牌面积分：\" + panGameInfo[i].points + \"\\n队伍积分：\" + panGameInfo[i].teamPoints \n        + \"\\n总计：\" + panGameInfo[i].total + \"\\n局分：\" + panGameInfo[i].juPoints;\n\n        i = (i + 1) % 2;\n        label = this.panOver.getChildByName(\"计分板\").getChildByName(\"他队积分详情\").getComponent(Label);\n        label.string = \"牌面积分：\" + panGameInfo[i].points + \"\\n队伍积分：\" + panGameInfo[i].teamPoints \n        + \"\\n总计：\" + panGameInfo[i].total + \"\\n局分：\" + panGameInfo[i].juPoints;\n    }\n    onUpdatePoints(data) {\n        let seat = (data.seat - globalThis._userInfo.room_seat + 4) % 4;\n        let panPoints = data.panPoints;\n        this.seatPanPoints[seat].string = \"盘:\" + panPoints;\n        this.seatPanPoints[(seat + 2) % 4].string = \"盘:\" + panPoints;\n    }\n\n    \n    onRequestRoomInfo(data){\n        let roomInfo = data.roomInfo;\n        this.roomId.string = roomInfo.roomId;\n        this.gamecount.string = roomInfo.currentNumbers + \"/\" + roomInfo.gameNumbers + \"局 \" + roomInfo.scoreNumbers + \"分\";\n        this.updateAllSeats(roomInfo);\n    }\n\n    updateAllSeats(roomInfo){\n        this.pokerView.active = false;\n        let users: GameRole[] = roomInfo.gameRoles;\n        //先找到本玩家座位号\n        let cur = 0;\n        for(let i = 0; i < 4; i++){\n            if(users[i] == null){\n                continue;\n            }\n            if(users[i].userId == globalThis._userInfo.user_id){\n                cur = i;\n                break;\n            }\n        }\n        globalThis._userInfo.room_seat = cur;\n        //渲染各座位信息\n        for(let i = 0, j = cur; i < 4; i++, j++){\n            if(j >= 4)j -= 4;\n            if(users[j] == null)continue;\n            this.seatName[i].string = users[j].userName;\n            this.seatTotalPoints[i].string = \"总分:\" + users[j].totalPoints;\n            this.seatJuPoints[i].string = \"局:\" + users[j].juPoints;\n            this.seatPanPoints[i].string = \"盘:\" + users[j].panPoints;\n            this.readyOk[i].active = (users[j].userStatus.status == \"READY\");\n            this.passLable[i].active = false;\n        }\n        let status = users[0].userStatus.status;\n        //还未发牌\n        if(status == \"UNREADY\" || status == \"READY\"){\n            for(let i = 0, j = cur; i < 4; i++, j++){\n                this.pushCardsView[i].active = false;\n                if(j >= 4)j -= 4;\n                if(users[j] == null)continue;\n                let bool = users[j].userStatus.status == \"READY\";\n                this.readyOk[i].active = bool;\n            }\n            let bool = users[cur].userStatus.status == \"READY\";\n            this.readyBtn.active = !bool;\n            this.cancelReadyBtn.active = bool;\n            if(roomInfo.readyNumbers == 4 && globalThis._userInfo.user_id == roomInfo.createUserId)this.startBtn.active = true;\n            else this.startBtn.active = false;\n        }else {\n            //已经发牌了\n            //显示玩家手牌\n            this.cardList = users[cur].userCards;\n            let bool = true;\n            for(let i = 0, j = cur; i < 4; i++, j++){\n                if(j >= 4)j -= 4;\n                let status = users[j].userStatus.status;\n                if(status == \"PLAYED\"){\n                    let cardList = users[j].userStatus.data;\n                    this.showPushCards(i, cardList);\n                    bool = false;\n                }else if(status == \"PLAYING\"){\n                    // this.onloadAtlas(j);\n                    this.showPoker(j);\n                    if(j == cur){\n                        for(let p = 0, q = cur; p < 4; p++, q--){\n                            if(q < 0)q += 4;\n                            if(users[q].userStatus.status == \"PLAYED\"){\n                                this.pushcardVo.prePushSeat = q;\n                                break;\n                            }\n                        }\n                    }\n                }else if(status == \"PASS\"){\n                    this.passLable[i].active = true;\n                }else if(status == \"END\"){\n                    //\n                }\n            }\n            if(users[cur].userStatus.status == \"PLAYING\"){\n                this.pushCardBtn.active = true;\n                this.passBtn.active = bool;\n            }\n            this.paiPoints.string = \"牌面积分:\" + roomInfo.curPoints;\n        }\n    }\n\n    onUserReady(data){\n        let mySeat = globalThis._userInfo.room_seat;\n        if(data.readyNumbers == 4 && globalThis._userInfo.user_id == data.createUserId)this.startBtn.active = true;\n        else this.startBtn.active = false;\n        let seat = data.seat;\n        let ready:boolean = (data.isReady == 1);\n        this.readyOk[(seat - mySeat + 4) % 4].active = ready;\n        \n    }\n    onReadyBtnClicked(){\n        this.bzdSoundMgt.play(\"button\");\n        this.readyBtn.active = false;\n        this.cancelReadyBtn.active = true;\n        globalThis._BZDClient.sendMessage(\"userReady\",{seat:globalThis._userInfo.room_seat, isReady: 1, roomId:globalThis._userInfo.room_id})\n    }\n\n    onCancelReadyBtnClicked(){\n        this.bzdSoundMgt.play(\"button\");\n        this.readyBtn.active = true;\n        this.cancelReadyBtn.active = false;\n        globalThis._BZDClient.sendMessage(\"userReady\",{seat:globalThis._userInfo.room_seat, isReady: -1, roomId:globalThis._userInfo.room_id})\n    }\n\n    onStartBtnClicked(){\n        this.bzdSoundMgt.play(\"button\");\n        globalThis._BZDClient.sendMessage(\"dealCards\",{});\n    }\n\n    onExitRoomBtnClicked(){\n        this.bzdSoundMgt.play(\"button\");\n        director.loadScene(\"HallScene\");\n    }\n\n    onDealCards(data){\n        console.log(\"获得牌型：\",data);\n        this.bzdSoundMgt.play(\"DealFold\");\n        \n        this.startBtn.active = false;\n        this.readyBtn.active = false;\n        this.cancelReadyBtn.active = false;\n        //初始化各出牌区域\n        for(let i = 0; i < 4; i++){\n            this.cleanPushCards(i);\n        }\n        for(let i = 0; i < 4; i++){\n            this.readyOk[i].active = false;\n        }\n        let cards = data.cardList[globalThis._userInfo.room_seat];\n        let pushSeat = data.pushSeat;\n        this.cardList = cards;\n        this.pushcardVo.prePushSeat = pushSeat;\n        // this.onloadAtlas(pushSeat);\n        this.showPoker(pushSeat);\n    }\n\n    onloadAtlas(j) {\n        // resources.load(\"image/games/bazhadan/card/pokerlist\", SpriteAtlas, (err, spriteAtlas)=>{\n        //     if(err)console.log(\"load atlas err: \", err);\n        //     else {\n        //         this.pokerAtlas = spriteAtlas;\n        //         this.showPoker(j);\n        //     }\n        // })\n\n        this.showPoker(j);\n    }\n    showPoker(j) {\n        this.pokerView.active = true;\n        this.passBtn.active = false;\n        this.pushCardBtn.active = false;\n        let bpk = this.pokerAtlas.getSpriteFrame(\"0\");\n        let x = -360, y = -50, z = 0;\n        for(let i = 0; i < this.cardList.length; i++){\n            if(i == 17){\n                y = -150;\n                x -= 850;\n            }\n            let pk = this.pokerAtlas.getSpriteFrame(this.cardList[i]+\"\");\n            let cardName = \"card\" + i;\n            let cardNode = this.pokerView.getChildByName(cardName);\n            cardNode.setPosition(new Vec3(0, 185, 0));\n            cardNode.active = true;\n            let sp = cardNode.getComponent(Sprite);\n            sp.spriteFrame = bpk;\n            tween(cardNode).to(1.5,{position: new Vec3(i*50+x, y, z)})\n            .call(() => {\n                sp.spriteFrame = pk;\n                if(i == 26){        \n                    if(globalThis._userInfo.room_seat == j){\n                        this.pushCardBtn.active = true;\n                        if(globalThis._userInfo.room_seat != this.pushcardVo.prePushSeat){\n                            this.passBtn.active = true;\n                        }\n                    }\n                }\n            }).start();\n        }\n    }\n\n    onCardClicked(type,arg){\n        this.bzdSoundMgt.play(\"SpecSelectCard\");\n        let cardName = \"card\" + arg;\n        let cardNode = this.pokerView.getChildByName(cardName);\n        \n        let p = cardNode.getPosition()\n        if(this.cardSet.has(arg)){\n            this.cardSet.delete(arg);\n            p.y -= 30;\n        }else {\n            this.cardSet.add(arg);\n            p.y += 30;\n        }\n        cardNode.setPosition(p);\n    }\n\n    onPushCardBtnClicked(){\n        console.log(\"出牌！\")\n        console.log(this.pushcardVo);\n        console.log(JSON.stringify(this.pushcardVo));\n        this.pushcardVo.curCardList.length = 0;\n        \n        let cards = Array.from(this.cardSet);\n        cards.sort((a, b) => a - b);\n        console.log(\"eee:\",cards);\n        for(let i of cards){\n            let cardName = \"card\" + i;\n            let cardNode = this.pokerView.getChildByName(cardName);\n            let sp = cardNode.getComponent(Sprite);\n            let spf = sp.spriteFrame;\n            let cardValue = spf.name;\n            this.pushcardVo.curCardList.push(Number(cardValue));\n        }\n        this.pushcardVo.curSeat = globalThis._userInfo.room_seat;\n        globalThis._BZDClient.sendMessage(\"pushCards\",{pushCardsInfo: JSON.stringify(this.pushcardVo)});\n        \n    }\n\n    randomAudioName(type){\n        const random = (min:any,max:any) => Math.floor(Math.random() * (max - min + 1) + min)\n        let arr:any = [\"Woman_\",\"Man_\"]\n            \n        let idx = random( 0,1)\n        if(type == \"buyao\"){\n            let idx = random(1, 4);\n            type += idx;\n        }\n        return arr[idx] + type;\n    }\n    onPushCards(data){\n        this.pushcardVo = data.pushCardsInfo;\n        let curSeat = globalThis._userInfo.room_seat;\n        let isRight: boolean = data.isRight;\n        let audioName = this.randomAudioName(this.pushcardVo.type);\n        //出牌正确\n        if(isRight){\n            this.bzdSoundMgt.play(audioName);\n            //是我出的牌\n            if(curSeat == this.pushcardVo.preSeat){\n                if(this.pushcardVo.preStatus == \"PLAYED\"){\n                    this.bzdSoundMgt.play(\"Special_give\")\n                    let length = this.cardSet.size;\n                    let d_x = 30;\n                    let x = -70 - d_x * (length / 2);\n                    let cards = Array.from(this.cardSet);\n                    cards.sort((a, b) => a - b);\n                    for(let i of cards){\n                        // this.pushCardSet.add(i);\n                        let cardName = \"card\" + i;\n                        let cardNode = this.pokerView.getChildByName(cardName);\n                        cardNode.active = false;\n                        // tween(cardNode).to(0.8,{position: new Vec3(x,90,0)}).start();\n                        // x += d_x;\n                    }\n                    let cardList = this.pushcardVo.preCardList;                   \n                    this.showPushCards(0, cardList);\n                    this.cardSet.clear();\n                    //调整剩余牌序\n                    x = -360; let y = -50, z = 0;\n                    this.cardList = this.pushcardVo.preUserCards;\n                    for(let i = 0; i < this.cardList.length; i++){\n                        if(i == 17){\n                            y = -150;\n                            x -= 850;\n                        }\n                        let pk = this.pokerAtlas.getSpriteFrame(this.cardList[i]+\"\");\n                        let cardName = \"card\" + i;\n                        let cardNode = this.pokerView.getChildByName(cardName);\n                        let sp = cardNode.getComponent(Sprite);\n                        sp.spriteFrame = pk;\n                        cardNode.setPosition(new Vec3(i*50+x, y, z));\n                        cardNode.active = true;\n                    }\n                    for(let i = this.cardList.length; i < 27; i++){\n                        let cardName = \"card\" + i;\n                        let cardNode = this.pokerView.getChildByName(cardName);\n                        cardNode.active = false;\n                    }\n\n                    this.passBtn.active = false;\n                    this.pushCardBtn.active = false;\n                }else if(this.pushcardVo.preStatus == \"PASS\"){\n                    \n                }\n            }\n            \n            //不是我出的牌，将对应出牌位置更新\n            else{\n                //先更新出牌位置信息(将牌型展出)，到下一家出牌\n                let seat = (this.pushcardVo.preSeat - curSeat + 4) % 4;\n                this.cleanPushCards(seat);\n                if(this.pushcardVo.preSeat == this.pushcardVo.prePushSeat){//if(this.pushcardVo.preStatus == \"PLAYED\")\n                    let cardList = this.pushcardVo.preCardList;                   \n                    this.showPushCards(seat, cardList);\n                }else if(this.pushcardVo.preStatus == \"PASS\"){\n                    this.passLable[seat].active = true;\n                }else if(this.pushcardVo.preStatus == \"END\"){\n\n                }\n                \n                //如果下家是我\n                if((this.pushcardVo.preSeat + 1) % 4 == curSeat){\n                    // for(let i of this.pushCardSet){\n                    //     let cardName = \"card\" + i;\n                    //     let cardNode = this.pokerView.getChildByName(cardName);\n                    //     cardNode.active = false;\n                    // }\n                    // this.pushCardSet.clear();\n                    if(this.pushcardVo.myStatus == \"PLAYING\"){\n                        this.cleanPushCards(0);\n                        if(globalThis._userInfo.room_seat == this.pushcardVo.prePushSeat)\n                            this.passBtn.active = false;\n                        else \n                            this.passBtn.active = true;\n                        this.pushCardBtn.active = true;\n                    }else if(this.pushcardVo.myStatus == \"END\"){\n                        this.pushcardVo.curSeat = globalThis._userInfo.room_seat;\n                        globalThis._BZDClient.sendMessage(\"userEnd\",{pushCardsInfo: JSON.stringify(this.pushcardVo)});\n                    }else if(this.pushcardVo.myStatus == \"OVER\"){\n                        console.log(\"游戏结束!\")\n                        this.pushcardVo.curSeat = globalThis._userInfo.room_seat;\n                        globalThis._BZDClient.sendMessage(\"panGameOver\",{pushCardsInfo: JSON.stringify(this.pushcardVo)});\n                    }else if(this.pushcardVo.myStatus == \"TOTEAMMATE\"){\n                        this.pushcardVo.curSeat = globalThis._userInfo.room_seat;\n                        globalThis._BZDClient.sendMessage(\"TOTEAMMATE\",{pushCardsInfo: JSON.stringify(this.pushcardVo)});\n                    }\n                }\n            }\n            this.paiPoints.string = \"牌面积分:\" + this.pushcardVo.points;\n        }\n        //出牌不正确\n        else {\n            if(curSeat == this.pushcardVo.curSeat){\n                //是我出的牌\n                this.bzdSoundMgt.play(\"SpecSysReturnFail\");\n                console.log(\"不能这样出牌！\");\n            }\n            else {\n                //不是我出的牌，不用管\n            }\n        }\n    }\n    showPushCards(seat, cardList){\n        let pushCardsView = this.pushCardsView[seat];\n        for(let i = 0; i < cardList.length; i++){\n            let pk = this.pokerAtlas.getSpriteFrame(cardList[i]+\"\");\n            let cardName = \"card\" + i;\n            let cardNode = pushCardsView.getChildByName(cardName);\n            let sp = cardNode.getComponent(Sprite);\n            sp.spriteFrame = pk;\n            cardNode.active = true;\n        }\n    }\n    showPushCardsBtn() {\n        console.log(\"1:\",globalThis._userInfo.room_seat);\n        console.log(\"2:\",this.pushcardVo.prePushSeat);\n        if(globalThis._userInfo.room_seat == this.pushcardVo.prePushSeat)\n            this.passBtn.active = false;\n        else \n            this.passBtn.active = true;\n\n        if(globalThis._userInfo.room_seat == (this.pushcardVo.preSeat + 1) % 4)\n            this.pushCardBtn.active = true;\n\n        console.log(this.pushCardBtn.active);\n    }\n\n    onPassBtnClicked(){\n        this.passBtn.active = false;\n        this.pushCardBtn.active = false;\n        this.passLable[0].active = true;\n        this.pushcardVo.curSeat = globalThis._userInfo.room_seat;\n        this.cleanCardSet();\n        globalThis._BZDClient.sendMessage(\"passCards\",{pushCardsInfo: JSON.stringify(this.pushcardVo)});\n    }\n\n    cleanCardSet(){\n        for(let arg of this.cardSet){\n            let cardName = \"card\" + arg;\n            let cardNode = this.pokerView.getChildByName(cardName);\n            let p = cardNode.getPosition()\n            this.cardSet.delete(arg);\n            p.y -= 30;\n            cardNode.setPosition(p);\n        }\n    }\n\n    cleanPushCards(i){\n        let pcv = this.pushCardsView[i];\n        pcv.active = true;\n        for(let i = 0; i < 27; i++){\n            let cardName = \"card\" + i;\n            let cardNode = pcv.getChildByName(cardName);\n            // let sp = cardNode.getComponent(Sprite);\n            // sp.spriteFrame = null;\n            cardNode.active = false;\n        }\n        this.passLable[i].active = false;\n    }\n\n    onPanOverPageClosedBtnClicked(){\n        this.bzdSoundMgt.play(\"button\");\n        this.panOver.active = false;\n        this.pushcardVo = new PushCardVo();\n        globalThis._BZDClient.sendMessage(\"requestRoomInfo\",{});\n    }\n\n    playAudioEffect(name:string){\n        this.bzdSoundMgt.play(name);\n    }\n}\n\n\n"]}